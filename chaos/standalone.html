<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lightweight Charts - ç‹¬ç«‹æ¼”ç¤ºï¼ˆæ— éœ€æœåŠ¡å™¨ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .alert {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 5px;
            color: #856404;
        }

        .chart-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .chart-title {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .chart-container {
            width: 100%;
            height: 400px;
            position: relative;
        }

        .controls {
            margin-top: 15px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        button {
            padding: 10px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ“Š Lightweight Charts ç‹¬ç«‹æ¼”ç¤º</h1>

        <div class="alert">
            â„¹ï¸ <strong>æç¤ºï¼š</strong>è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨ CDN åŠ è½½åº“ï¼Œå¯ä»¥ç›´æ¥åŒå‡»æ‰“å¼€ï¼Œæ— éœ€å¯åŠ¨æœåŠ¡å™¨ã€‚
        </div>

        <div class="chart-section">
            <div class="chart-title">èœ¡çƒ›å›¾ï¼ˆKçº¿å›¾ï¼‰</div>
            <div id="candlestick-chart" class="chart-container"></div>
            <div class="controls">
                <button onclick="addNewData()">æ·»åŠ æ•°æ®</button>
                <button onclick="toggleTheme()">åˆ‡æ¢ä¸»é¢˜</button>
            </div>
        </div>

        <div class="chart-section">
            <div class="chart-title">çº¿å½¢å›¾</div>
            <div id="line-chart" class="chart-container"></div>
            <div class="controls">
                <button onclick="updateLineChart()">æ›´æ–°æ•°æ®</button>
            </div>
        </div>

        <div class="chart-section">
            <div class="chart-title">é¢ç§¯å›¾</div>
            <div id="area-chart" class="chart-container"></div>
        </div>
    </div>

    <!-- ä½¿ç”¨ CDN åŠ è½½ Lightweight Charts -->
    <script src="https://unpkg.com/lightweight-charts@5.0.9/dist/lightweight-charts.standalone.production.js"></script>
    
    <script>
        // æ£€æŸ¥åº“æ˜¯å¦åŠ è½½æˆåŠŸ
        if (typeof LightweightCharts === 'undefined') {
            alert('âŒ Lightweight Charts åº“åŠ è½½å¤±è´¥ï¼è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥ã€‚');
        }

        // ========== èœ¡çƒ›å›¾ ==========
        const candlestickChart = LightweightCharts.createChart(
            document.getElementById('candlestick-chart'),
            {
                width: document.getElementById('candlestick-chart').clientWidth,
                height: 400,
                layout: {
                    background: { color: '#ffffff' },
                    textColor: '#333',
                },
                grid: {
                    vertLines: { color: '#e1e1e1' },
                    horzLines: { color: '#e1e1e1' },
                },
                timeScale: {
                    timeVisible: true,
                    secondsVisible: false,
                },
            }
        );

        const candlestickSeries = candlestickChart.addSeries(LightweightCharts.CandlestickSeries, {
            upColor: '#26a69a',
            downColor: '#ef5350',
            borderVisible: false,
            wickUpColor: '#26a69a',
            wickDownColor: '#ef5350',
        });

        // ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®
        function generateCandlestickData(count = 100) {
            const data = [];
            let basePrice = 100;
            const startTime = Math.floor(Date.now() / 1000) - count * 86400;

            for (let i = 0; i < count; i++) {
                const time = startTime + i * 86400;
                basePrice += (Math.random() - 0.5) * 3;
                
                const open = basePrice + (Math.random() - 0.5) * 2;
                const close = basePrice + (Math.random() - 0.5) * 2;
                const high = Math.max(open, close) + Math.random() * 2;
                const low = Math.min(open, close) - Math.random() * 2;

                data.push({ time, open, high, low, close });
            }
            return data;
        }

        let candleData = generateCandlestickData(100);
        candlestickSeries.setData(candleData);

        let isDark = false;
        function toggleTheme() {
            isDark = !isDark;
            candlestickChart.applyOptions({
                layout: {
                    background: { color: isDark ? '#1e1e1e' : '#ffffff' },
                    textColor: isDark ? '#d1d4dc' : '#333',
                },
                grid: {
                    vertLines: { color: isDark ? '#2a2a2a' : '#e1e1e1' },
                    horzLines: { color: isDark ? '#2a2a2a' : '#e1e1e1' },
                },
            });
        }

        function addNewData() {
            const lastCandle = candleData[candleData.length - 1];
            const newTime = lastCandle.time + 86400;
            const basePrice = lastCandle.close;
            
            const open = basePrice + (Math.random() - 0.5) * 2;
            const close = basePrice + (Math.random() - 0.5) * 3;
            const high = Math.max(open, close) + Math.random() * 2;
            const low = Math.min(open, close) - Math.random() * 2;

            const newCandle = { time: newTime, open, high, low, close };
            candleData.push(newCandle);
            candlestickSeries.update(newCandle);
        }

        // ========== çº¿å½¢å›¾ ==========
        const lineChart = LightweightCharts.createChart(
            document.getElementById('line-chart'),
            {
                width: document.getElementById('line-chart').clientWidth,
                height: 400,
                layout: {
                    background: { color: '#ffffff' },
                    textColor: '#333',
                },
                grid: {
                    vertLines: { color: '#e1e1e1' },
                    horzLines: { color: '#e1e1e1' },
                },
            }
        );

        const lineSeries = lineChart.addSeries(LightweightCharts.LineSeries, {
            color: '#2962FF',
            lineWidth: 2,
        });

        function generateLineData(count = 100) {
            const data = [];
            let value = 100;
            const startTime = Math.floor(Date.now() / 1000) - count * 86400;

            for (let i = 0; i < count; i++) {
                value += (Math.random() - 0.5) * 5;
                data.push({
                    time: startTime + i * 86400,
                    value: value,
                });
            }
            return data;
        }

        lineSeries.setData(generateLineData(100));

        function updateLineChart() {
            lineSeries.setData(generateLineData(100));
        }

        // ========== é¢ç§¯å›¾ ==========
        const areaChart = LightweightCharts.createChart(
            document.getElementById('area-chart'),
            {
                width: document.getElementById('area-chart').clientWidth,
                height: 400,
                layout: {
                    background: { color: '#ffffff' },
                    textColor: '#333',
                },
            }
        );

        const areaSeries = areaChart.addSeries(LightweightCharts.AreaSeries, {
            topColor: 'rgba(38, 166, 154, 0.4)',
            bottomColor: 'rgba(38, 166, 154, 0.0)',
            lineColor: 'rgba(38, 166, 154, 1)',
            lineWidth: 2,
        });

        areaSeries.setData(generateLineData(80));

        // å“åº”å¼è°ƒæ•´
        window.addEventListener('resize', () => {
            candlestickChart.applyOptions({
                width: document.getElementById('candlestick-chart').clientWidth
            });
            lineChart.applyOptions({
                width: document.getElementById('line-chart').clientWidth
            });
            areaChart.applyOptions({
                width: document.getElementById('area-chart').clientWidth
            });
        });

        console.log('âœ… Lightweight Charts åŠ è½½æˆåŠŸï¼');
    </script>
</body>
</html>

