<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>v5 API æµ‹è¯•</title>
    <style>
        body { padding: 20px; background: #f5f5f5; font-family: Arial; }
        #chart { background: white; width: 800px; height: 400px; margin: 20px auto; }
        .info { max-width: 800px; margin: 0 auto; padding: 10px; background: #fff; }
    </style>
</head>
<body>
    <div class="info">
        <h1>Lightweight Charts v5 API æµ‹è¯•</h1>
        <p id="status">æ­£åœ¨åŠ è½½...</p>
    </div>
    <div id="chart"></div>

    <script src="node_modules/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>
    <script>
        const statusEl = document.getElementById('status');

        try {
            // æ£€æŸ¥ LightweightCharts å¯¹è±¡
            console.log('LightweightCharts:', LightweightCharts);
            console.log('LightweightCharts keys:', Object.keys(LightweightCharts));

            // åˆ›å»ºå›¾è¡¨
            const chart = LightweightCharts.createChart(document.getElementById('chart'), {
                width: 800,
                height: 400,
            });

            statusEl.innerHTML = 'âœ… å›¾è¡¨åˆ›å»ºæˆåŠŸï¼<br>';

            // v5 API: ä½¿ç”¨ addSeries æ–¹æ³•
            // éœ€è¦å…ˆè·å– series definitions
            const { candlestickSeries, lineSeries, areaSeries, histogramSeries } = LightweightCharts;

            console.log('candlestickSeries:', candlestickSeries);
            console.log('lineSeries:', lineSeries);

            // æ·»åŠ èœ¡çƒ›å›¾ç³»åˆ—
            const series = chart.addSeries(candlestickSeries, {
                upColor: '#26a69a',
                downColor: '#ef5350',
                borderVisible: false,
                wickUpColor: '#26a69a',
                wickDownColor: '#ef5350',
            });

            statusEl.innerHTML += 'âœ… èœ¡çƒ›å›¾ç³»åˆ—æ·»åŠ æˆåŠŸï¼<br>';

            // è®¾ç½®æ•°æ®
            const data = [
                { time: '2024-01-01', open: 100, high: 105, low: 95, close: 102 },
                { time: '2024-01-02', open: 102, high: 110, low: 100, close: 108 },
                { time: '2024-01-03', open: 108, high: 112, low: 105, close: 107 },
                { time: '2024-01-04', open: 107, high: 115, low: 106, close: 113 },
                { time: '2024-01-05', open: 113, high: 118, low: 110, close: 116 },
            ];

            series.setData(data);
            statusEl.innerHTML += 'âœ… æ•°æ®è®¾ç½®æˆåŠŸï¼<br>';
            statusEl.innerHTML += '<strong>ğŸ‰ å›¾è¡¨å®Œå…¨æ­£å¸¸å·¥ä½œï¼</strong>';

        } catch (error) {
            statusEl.innerHTML = 'âŒ é”™è¯¯: ' + error.message;
            console.error(error);
        }
    </script>
</body>
</html>


